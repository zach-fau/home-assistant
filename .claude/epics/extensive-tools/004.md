---
name: Unified News Integration (AP News + NYT)
status: open
created: 2025-10-30T22:18:30Z
updated: 2025-10-30T22:18:30Z
github: null
depends_on: [001]
parallel: true
conflicts_with: []
---

# Task 004: Unified News Integration (AP News + NYT)

## Metadata

- **Effort**: 6 hours (S)
- **Phase**: Phase 2 - News + Briefing MVP
- **Dependencies**: Task 001 (needs config system)
- **Parallel**: Yes (can run alongside other Phase 2 tasks)
- **Conflicts**: None

## Description

Implement unified news module supporting both AP News and NYT APIs with configurable sources, sections, and article limits. Voice-optimized summaries for briefing integration.

## Context

This task creates a single `news.py` module that supports both AP News and NYT APIs, following the architectural decision (AD2) to batch news sources into one unified implementation. The module will provide voice-optimized summaries suitable for morning briefing integration and standalone voice queries.

## Technical Approach

**Architecture**:
- Single `functions/news.py` with unified API client pattern
- Configurable source selection (AP News, NYT, or both)
- Section-based filtering (politics, tech, business, etc.)
- Caching layer with 1-hour TTL to respect rate limits
- Voice-optimized summaries (1-2 sentences per article)

**API Integration**:
- AP News API (user subscription required)
- NYT API (user subscription required)
- Unified response format regardless of source
- Error handling with graceful degradation

**Function Handlers**:
- `get_news_headlines()` - Latest headlines from configured sources
- `get_news_by_section(section)` - Section-specific news (tech, politics, etc.)
- `search_news(query)` - Search across news sources

## Acceptance Criteria

- [ ] `functions/news.py` created with unified API client
- [ ] AP News API integration (using user subscription)
- [ ] NYT API integration (using user subscription)
- [ ] Configurable sources and sections (politics, tech, business, etc.)
- [ ] Voice-optimized summaries (1-2 sentences per article)
- [ ] Function handlers: get headlines, get articles by section, search articles
- [ ] Caching (1 hour TTL to respect rate limits)
- [ ] Function schemas for news functions
- [ ] All functions registered in `functions/__init__.py`
- [ ] Voice commands working: "What's the latest news?", "Any tech news today?"

## Files Created/Modified

### New Files
- `functions/news.py` - Unified news API client and function handlers

### Modified Files
- `functions/__init__.py` - Register news functions
- `.env` - Add `AP_NEWS_API_KEY`, `NYT_API_KEY`

## Testing

**Manual Testing**:
1. Voice command: "What's the latest news?"
2. Voice command: "Any tech news today?"
3. Voice command: "Search news for AI developments"
4. Verify caching: Second query within 1 hour should use cached data
5. Test graceful degradation: Disable one API key, verify other source still works

**Integration Testing**:
- Verify function registration in `functions/__init__.py`
- Test with both API keys configured
- Test with only one API key configured
- Verify error handling for API failures

## Dependencies

**External**:
- AP News API subscription
- NYT API subscription

**Internal**:
- Task 001 (configuration system for news settings)

## Implementation Notes

- Follow existing pattern from `google_tasks.py`, `web_search.py`
- Use `@functools.lru_cache` with TTL for caching
- Implement unified response format: `{"source": "ap|nyt", "title": str, "summary": str, "url": str}`
- Voice summaries should be concise (1-2 sentences max)
- Handle API rate limits gracefully with exponential backoff

## Success Metrics

- Voice news queries return results in <3 seconds
- Cache hit rate >50% for repeated queries
- Both API sources working independently and together
- Summaries are voice-optimized (conversational, concise)
