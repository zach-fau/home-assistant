---
name: Briefing Polish (Skip, Templates, Context-Aware)
status: open
created: 2025-10-30T22:18:30Z
updated: 2025-10-30T22:18:30Z
github: null
depends_on: [005]
parallel: true
conflicts_with: [005]
---

# Task 006: Briefing Polish (Skip, Templates, Context-Aware)

## Metadata

- **Effort**: 2 hours (XS)
- **Phase**: Phase 2 - News + Briefing MVP
- **Dependencies**: Task 005 (needs core briefing)
- **Parallel**: Yes (polish features, non-blocking)
- **Conflicts**: Task 005 (modifies same briefing files)

## Description

Add skip functionality, weekday/weekend templates, and context-aware adaptations to morning briefing for production-ready UX.

## Context

This task polishes the core briefing system (Task 005) with user experience improvements. These features make the briefing more flexible, natural, and context-aware without requiring new integrations or infrastructure.

## Technical Approach

**Skip Functionality**:
- Monitor for interrupt phrases: "Skip news", "Next section", "Skip this"
- Use STT interrupt detection to pause current section
- Jump to next section in briefing narrative
- Resume natural flow

**Templates**:
- Weekday template: Formal, productivity-focused (work calendar, tasks, traffic)
- Weekend template: Casual, leisure-focused (no work calendar, entertainment)
- Auto-detect based on current day (Monday-Friday vs Saturday-Sunday)
- Configurable in YAML

**Context-Aware Adaptations**:
- Mention gym if workout scheduled in calendar
- Add traffic info if commute event detected
- Adjust tone based on time (late = urgent, early = relaxed)
- Omit empty sections (e.g., no packages → skip package section)

## Acceptance Criteria

- [ ] Skip functionality: user can say "Skip news", "Next section"
- [ ] Weekday vs weekend briefing templates (formal vs casual)
- [ ] Context-aware adaptations (e.g., mentions gym if workout scheduled)
- [ ] Configurable component enable/disable in YAML
- [ ] Voice interruption handling
- [ ] Briefing quality validation (coherent narrative, natural phrasing)
- [ ] Performance: briefing completes in <30 seconds
- [ ] All features documented in briefing config

## Files Created/Modified

### Modified Files
- `functions/briefing/manager.py` - Add skip, templates, context logic
- `config/briefing_config.yaml` - Add template settings

## Testing

**Manual Testing**:
1. Say "Good morning" → Verify weekday template (if Monday-Friday)
2. During briefing, say "Skip news" → Verify skips to next section
3. Say "Next section" → Verify immediate skip
4. Add workout to calendar, trigger briefing → Verify gym mention
5. Weekend morning → Verify casual template

**Integration Testing**:
- Test skip interruption at various points in briefing
- Verify weekday/weekend detection
- Test context adaptations (workout, commute, late start)
- Verify empty section handling (no packages → skip section)
- Performance: Ensure additions don't slow briefing

## Dependencies

**Internal**:
- Task 005 (core briefing system)

## Implementation Notes

**Skip Implementation**:
```python
class BriefingManager:
    def __init__(self, config, llm, tts):
        self.current_section = None
        self.skip_requested = False

    def on_interrupt(self, text: str):
        """Handle voice interruptions during briefing."""
        if any(phrase in text.lower() for phrase in ["skip", "next section", "next"]):
            self.skip_requested = True

    async def deliver_briefing(self):
        sections = self._get_sections()
        for section in sections:
            if self.skip_requested:
                self.skip_requested = False
                continue
            await self._speak_section(section)
```

**Template Selection**:
```python
def _select_template(self) -> str:
    """Select briefing template based on day of week."""
    now = datetime.now()
    is_weekend = now.weekday() in [5, 6]  # Saturday, Sunday
    return 'weekend' if is_weekend else 'weekday'

def _format_narrative(self, data: dict) -> str:
    template = self._select_template()
    if template == 'weekend':
        return self._format_weekend_briefing(data)
    else:
        return self._format_weekday_briefing(data)
```

**Context Detection**:
```python
def _detect_context(self, calendar_events: list) -> dict:
    """Extract context from calendar for adaptations."""
    context = {
        'has_workout': any('gym' in e.summary.lower() or 'workout' in e.summary.lower() for e in calendar_events),
        'has_commute': any('commute' in e.summary.lower() for e in calendar_events),
        'first_event_time': calendar_events[0].start if calendar_events else None
    }
    return context
```

**YAML Configuration**:
```yaml
morning_briefing:
  templates:
    weekday:
      tone: formal
      include_work_calendar: true
      include_traffic: true
    weekend:
      tone: casual
      include_work_calendar: false
      include_traffic: false

  context_adaptations:
    workout_mention: true
    commute_info: true
    empty_section_skip: true
```

## Success Metrics

- Skip functionality responds in <500ms
- Template selection is automatic and correct
- Context adaptations feel natural and relevant
- Briefing remains <30 seconds with all features
- Zero crashes or errors during polishing features

## Future Enhancements (Not in This Task)

- Multi-user profiles (different templates per user)
- Machine learning for personalized adaptations
- Gentle wake-up mode (sound fade-in)
- Mobile app control for briefing settings
