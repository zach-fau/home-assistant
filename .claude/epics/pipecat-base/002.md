---
name: Service Configuration
status: completed
created: 2025-10-29T00:19:22Z
updated: 2025-10-29T00:34:35Z
github: null
depends_on: [1]
parallel: false
conflicts_with: []
---

# Task: Service Configuration

## Description

Obtain API keys for all required AI services (Deepgram, OpenAI, Cartesia) and configure the environment file. This task establishes connectivity to external services that power the voice assistant's speech recognition, language processing, and speech synthesis capabilities.

**Critical Path:** Cannot proceed with pipeline testing until all API keys are obtained and configured.

## Acceptance Criteria

- [ ] Deepgram account created and API key obtained
- [ ] OpenAI account created and API key obtained
- [ ] Cartesia account created and API key obtained
- [ ] `.env` file created from `env.example` template
- [ ] All API keys properly configured in `.env`
- [ ] API key format validated (no extra spaces, quotes, etc.)
- [ ] Service connectivity verified with test requests
- [ ] API quotas and rate limits documented

## Technical Details

### Service Setup Steps

#### 1. Deepgram (Speech-to-Text)

**Create Account:**
- Visit: https://deepgram.com
- Sign up for free account
- Navigate to API Keys section
- Generate new API key

**Configuration:**
```bash
DEEPGRAM_API_KEY=your_deepgram_api_key_here
```

**Verify Quota:**
- Free tier: $200 credit for new accounts
- Usage: ~$0.0043 per minute of audio
- Sufficient for ~46,000 minutes of development

#### 2. OpenAI (Language Model)

**Create Account:**
- Visit: https://platform.openai.com
- Sign up for account
- Add payment method (required for API access)
- Navigate to API Keys section
- Generate new API key

**Configuration:**
```bash
OPENAI_API_KEY=sk-proj-your_openai_api_key_here
```

**Verify Quota:**
- Pay-as-you-go pricing
- GPT-4 Turbo: ~$0.01 per 1K input tokens, ~$0.03 per 1K output tokens
- Estimate: ~$0.50-2.00 per hour of conversation

#### 3. Cartesia (Text-to-Speech)

**Create Account:**
- Visit: https://cartesia.ai
- Sign up for free account
- Navigate to API Keys section
- Generate new API key

**Configuration:**
```bash
CARTESIA_API_KEY=your_cartesia_api_key_here
```

**Verify Quota:**
- Free tier available
- Low latency TTS optimized for real-time
- Estimate: ~$0.10 per hour of synthesized speech

### Environment File Setup

1. **Copy Template**
   ```bash
   cd pipecat-quickstart
   cp env.example .env
   ```

2. **Edit Configuration**
   ```bash
   # .env file contents
   DEEPGRAM_API_KEY=your_deepgram_key
   OPENAI_API_KEY=your_openai_key
   CARTESIA_API_KEY=your_cartesia_key

   # Optional settings
   LOG_LEVEL=INFO
   ENABLE_METRICS=true
   ```

3. **Verify File Security**
   ```bash
   # Ensure .env is in .gitignore
   grep -q "^\.env$" .gitignore || echo ".env" >> .gitignore
   ```

### Key Considerations

- **Never Commit API Keys:** Ensure `.env` is gitignored
- **Key Format:** No quotes, spaces, or special characters around keys
- **Security:** API keys grant access to paid services - protect them
- **Cost Monitoring:** Set up billing alerts on each platform

### Files Affected

- `.env` (created from env.example)
- `.gitignore` (verify .env is excluded)

## Dependencies

### External Dependencies
- [ ] Credit card for OpenAI account verification
- [ ] Email access for account confirmations
- [ ] Valid payment method for paid services

### Task Dependencies
- [ ] Task 001 (Environment Setup) must be complete

## Effort Estimate

- **Size:** S
- **Hours:** 1-2 hours (account creation can involve verification delays)
- **Parallel:** false (needed before pipeline testing)

## Implementation Notes

### API Key Security Best Practices

1. **Never Share Keys Publicly**
   - Don't commit to version control
   - Don't share in screenshots or videos
   - Don't include in error logs

2. **Rotate Keys Regularly**
   - Generate new keys every 90 days
   - Revoke old keys after rotation

3. **Monitor Usage**
   - Set up billing alerts
   - Review usage dashboards weekly
   - Track costs per service

### Cost Optimization

**Development Phase:**
- Use GPT-3.5-turbo for initial testing (cheaper)
- Switch to GPT-4 once pipeline is stable
- Monitor daily spending

**Estimated Monthly Cost:**
- Development: $10-20/month
- Active testing: $50-100/month
- Production: $200-500/month (future)

### Troubleshooting Common Issues

**Issue:** OpenAI requires payment method immediately
**Solution:** Normal behavior - add credit card to activate API access

**Issue:** API key not working after configuration
**Solution:** Check for extra spaces or quotes in .env file
```bash
# Bad
DEEPGRAM_API_KEY=" your_key "

# Good
DEEPGRAM_API_KEY=your_key
```

**Issue:** Deepgram free credits not applied
**Solution:** Verify account email, credits may take 24 hours to appear

## Validation Tests

After configuration, test each service:

```bash
# Test 1: Verify .env loads
uv run python -c "import os; from dotenv import load_dotenv; load_dotenv(); print('Deepgram:', os.getenv('DEEPGRAM_API_KEY')[:10])"

# Should output first 10 chars of each key
```

## Definition of Done

- [ ] All three service accounts created
- [ ] API keys obtained and documented
- [ ] `.env` file created and configured
- [ ] `.env` is gitignored
- [ ] Key format validated
- [ ] Billing alerts configured on each platform
- [ ] Cost estimates documented
- [ ] Ready to proceed with pipeline validation

## References

- Deepgram: https://developers.deepgram.com
- OpenAI Platform: https://platform.openai.com/docs
- Cartesia: https://docs.cartesia.ai
- Pipecat Reference: `.claude/docs/pipecat-reference.md`
